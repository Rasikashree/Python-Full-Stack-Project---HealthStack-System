{% load static %}

<div class="profile-sidebar">
  <div class="widget-profile pro-widget-content">
    <div class="profile-info-widget">
      {% if doctor %}
        <a href="#" class="booking-doc-img">
          <img src="{{ doctor.featured_image.url }}" alt="User Image" />
        </a>
        <div class="profile-det-info">
          <h3>{{ doctor.name }}</h3>
          <div class="patient-details">
            <h5 class="mb-0">{{ doctor.specialization.specialization_name }}</h5>
          </div>
        </div>
      {% else %}
        <div class="profile-det-info">
          <h3>Doctor Info Not Available</h3>
        </div>
      {% endif %}
    </div>
  </div>

  <div class="dashboard-widget">
    <nav class="dashboard-menu sidebar">
      <ul>
        <li class="{% if request.resolver_match.url_name == 'doctor-dashboard' %}active{% endif %}">
          <a href="{% url 'doctor-dashboard' %}">
            <i class="fas fa-columns"></i>
            <span>Dashboard</span>
          </a>
        </li>

        {% if doctor %}
          <li class="{% if request.resolver_match.url_name == 'doctor-profile' %}active{% endif %}">
            <a href="{% url 'doctor-profile' pk=doctor.doctor_id %}">
              <i class="fas fa-user"></i>
              <span>Profile</span>
            </a>
          </li>

          <li>
            <a href="{% url 'appointments'%}">
              <i class="fas fa-user-circle"></i>
              <span>Appointment</span>
            </a>
          </li>

          <li class="nav-item has-submenu {% if request.resolver_match.url_name == 'patient-search' %}active{% endif %}">
            <a href="#" class="nav-link">
              <i class="fas fa-search"></i>
              <span>Patient ID</span>
            </a>
            <ul class="submenu">
              <li>
                <form action="{% url 'patient-search' pk=doctor.doctor_id %}" method="GET" style="margin:0;">
                  <input type="text" class="form-control" placeholder="Search patient ID" name="search_query" value="{{search_query}}">
                </form>
              </li>
            </ul>
          </li>
        {% endif %}

        <!-- Other menu items that don't depend on doctor -->
        <li class="{% if request.resolver_match.url_name == 'multiple-hospital' %}active{% endif %}">
          <a href="{% url 'multiple-hospital' %}">
            <i class="fas fa-hospital"></i>
            <span>Multiple Hospital</span>
          </a>
        </li>

        <li class="{% if request.resolver_match.url_name == 'my-patients' %}active{% endif %}">
          <a href="{% url 'my-patients' %}">
            <i class="fas fa-user-injured"></i>
            <span>My Patients</span>
          </a>
        </li>

        <!-- <li class="{% if request.resolver_match.url_name == 'doctor-test-list' %}active{% endif %}">
          <a href="{% url 'doctor-test-list'%}">
            <i class="fas fa-hourglass-start"></i>
            <span>Test Information</span>
          </a>
        </li> -->

        <li class="{% if request.resolver_match.url_name == 'doctor-profile-settings' %}active{% endif %}">
          <a href="{% url 'doctor-profile-settings' doctor.pk %}">
            <i class="fas fa-user-cog"></i>
            <span>Profile Settings</span>
          </a>
        </li>

        <li class="{% if request.resolver_match.url_name == 'doctor-change-password' %}active{% endif %}">
          <a href="{% url 'doctor-change-password' pk=user.id %}">
            <i class="fas fa-lock"></i>
            <span>Change Password</span>
          </a>
        </li>

        <li>
          <a href="{% url 'doctor-logout' %}">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
          </a>
        </li>
      </ul>
    </nav>
  </div>
</div>

<style>
  /* Sidebar alignment tweaks for consistent, neat layout */
  .dashboard-menu.sidebar ul { list-style: none; margin: 0; padding: 0; }
  .dashboard-menu.sidebar li { display:block; }
  .dashboard-menu.sidebar a { display:flex; align-items:center; gap:10px; padding:10px 14px; border-radius:8px; text-decoration:none; }
  .dashboard-menu.sidebar li.active > a, .dashboard-menu.sidebar a:hover { background:#f1f5f9; }
  .dashboard-menu .submenu { padding: 8px 14px 12px; }
  .dashboard-menu .submenu .form-control { width:100%; }
  .profile-sidebar .booking-doc-img img { width:80px; height:80px; object-fit:cover; border-radius:50%; }
  .profile-sidebar .profile-det-info h3 { margin-bottom:4px; }
  .profile-sidebar .patient-details h5 { margin:0; font-weight:500; }
  @media (max-width: 767px){ .dashboard-menu.sidebar a { padding:10px 12px; } }
</style>
